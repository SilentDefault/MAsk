<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title></title>
    <meta charset="utf-8" />
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
    <script src="Scripts/jquery-3.1.1.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script src="Scripts/bootbox.min.js"></script>
    <script src="Scripts/moment-with-locales.min.js"></script>
    <script src="Scripts/jquery.validate.min.js"></script>
    <script src="Scripts/js-cookie/js.cookie-2.1.3.min.js"></script>
    <script src="Scripts/tinymce/tinymce.min.js"></script>
    <script src="Scripts/vue.js"></script>
    <script src="Scripts/vue-resourse.js"></script>
    <script>
        moment.locale('es');
        $(document).ready(function() {
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.tab-pane').css('padding', '1%');
            } else {
                $('.tab-pane').css('padding-top', '1%');
                $('.tab-pane').css('padding-left', '20%');
                $('.tab-pane').css('padding-right', '20%');
            }
        });
    </script>
    <style>
        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body>
    <nav id="boarlinks" class="navbar randomColor" style="background-color: rebeccapurple; margin-bottom: 0px; border-radius: 0px;">
        <ol class="breadcrumb" style="white-space:nowrap;overflow-x:auto;">
            <li><a href="..">Home</a></li>
            <li v-cloak v-for="link in links"><a :href="link.url">{{link.Name}}</a></li>
        </ol>
        <div class="randomColor" style="background-color: rebeccapurple;text-align: center;">
            <div v-if="path != 'home'">
                <h1 style="margin-top: -1px;">
            <label>{{path}}</label>
        </h1>
                <label style="margin-bottom: -2px;">
            {{des}}
        </label>
            </div>
            <div v-else>
                <h1 style="margin-top: -1px;">
            <label>MAsk</label><kbd>ß</kbd>
            </h1>
                <label>
            The Massive Ask
        </label>
            </div>

        </div>
    </nav>
    <script>
        var path = window.location.pathname;

        var boarlinks = new Vue({
            el: '#boarlinks',
            data: {
                links: [],
                path: path,
                des: ''
            },
            methods: {
                cargarLinks() {
                    this.$http.post('zoe.asmx/BoardLinks')
                        .then(function(response) {
                            this.links = response.body.d;
                            if (this.path.length != 1) {
                                let tmp = response.body.d.filter(x => x.url == path.substring(1))[0];
                                this.path = tmp.Name;
                                this.des = tmp.Descripcion;
                            } else {
                                this.path = 'home'
                            }
                        })
                }
            },
            created: function() {
                this.cargarLinks();
            }
        })
    </script>
    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist" style="background-color:rebeccapurple;">
        <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Home</a></li>
        <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Profile</a></li>
        <li role="presentation"><a href="#messages" aria-controls="messages" role="tab" data-toggle="tab">Messages</a></li>
        <li role="presentation"><a href="#settings" aria-controls="settings" role="tab" data-toggle="tab">Settings</a></li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade in active" id="home">
            <div id="post">
                <table v-cloak v-for="pst in posts" class="auto-style2" style="border-bottom: 1px solid #ccd6dd;width: 100%">
                    <tbody>
                        <tr>
                            <td class="auto-style3">
                                <div v-html="pst.User != '---' ? (pst.Mask != 'Anónimo' ? '<a>'+pst.User+'</a> ['+pst.Mask+']' : '<a>'+pst.User+'</a>') : pst.Mask"></div>
                            </td>
                            <td class="auto-style3" style="text-align:right"><abbr :title="pst.Date"><div v-html="pst.Date"></div></abbr></td>
                        </tr>
                        <tr>
                            <td class="hide"><img src="" alt="Alternate Text"><video controls="controls"><source src="n/a" type="video/mp4"><source src="n/a" type="video/webm"></video></td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <p style="text-align: center;">
                                    <div v-html="pst.Content"></div>
                                </p>
                            </td>
                        </tr>
                        <tr>
                            <td class="auto-style3" :id="'estado'+pst.ID">Aplausos:{{pst.Aplausos}} Piedra:{{pst.Piedra}} Papel:{{ pst.Papel}}Tijeras:{{pst.Tijeras}}</td>
                            <td style="text-align:right"><a :href="'javascript:commentar('+pst.ID+');'">Comentarios: <label id="'commentNumber'+pst.ID">{{pst.Comments}}</label></a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <script>
                var post = new Vue({
                    el: '#post',
                    data: {
                        posts: []
                    },
                    methods: {
                        Posts() {
                            this.$http.post('zoe.asmx/Posts', {
                                    board: path.length != 1 ? path.substring(1) : 'dev'
                                })
                                .then(function(response) {
                                    this.posts = response.body.d;
                                })
                                .catch(function(error) {
                                    // TODO : Falta por controlar
                                })
                        },

                    },
                    created: function() {
                        this.Posts();
                    }
                })
            </script>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="profile">...</div>
        <div role="tabpanel" class="tab-pane fade" id="messages">...</div>
        <div role="tabpanel" class="tab-pane fade" id="settings">...</div>
    </div>
</body>

</html>
